import{_ as I,d as D,r as u,c as v,o as h,b as c,a,w as s,F as X,f as j,g as V,t as K,h as O,i as y,j as L,e as B,k as $,l as P,u as U,m as N,n as k,p as q,q as z,M as A,s as W,v as Z,x as G}from"./index-DYc8clNA.js";import{u as Q}from"./loading-CJ9iuUov.js";const E=""+new URL("login-banner-Cqtv5-d6.png",import.meta.url).href,H=D({setup(){return{carouselItem:O(()=>[{slogan:"开箱即用的高质量模板",subSlogan:"丰富的的页面模板，覆盖大多数典型业务场景",image:E},{slogan:"内置了常见问题的解决方案",subSlogan:"国际化，路由配置，状态管理应有尽有",image:E},{slogan:"接入可视化增强工具AUX",subSlogan:"实现灵活的区块式开发",image:E}])}}}),J={class:"banner"},Y={class:"banner-inner"},x={class:"carousel-title"},ee={class:"carousel-sub-title"},oe=["src"];function ae(e,o,g,i,r,t){const l=u("a-carousel-item"),m=u("a-carousel");return h(),v("div",J,[c("div",Y,[a(m,{class:"carousel","auto-play":{interval:5e3},"move-speed":2e3,"animation-name":"fade"},{default:s(()=>[(h(!0),v(X,null,j(e.carouselItem,n=>(h(),V(l,{key:n.slogan},{default:s(()=>[(h(),v("div",{key:n.slogan,class:"carousel-item"},[c("div",x,K(n.slogan),1),c("div",ee,K(n.subSlogan),1),c("img",{class:"carousel-image",src:n.image,alt:""},null,8,oe)]))]),_:2},1024))),128))]),_:1})])])}const se=I(H,[["render",ae],["__scopeId","data-v-4fc5eccf"]]),R="username",S="remember",ue=D({emits:["callRegister","callForgotPassword"],setup(e,o){const g=$(!0),i=P({userName:"",password:"",captcha_code:"",captcha_id:""}),r=$({captcha_id:"",captcha_base64:""}),t=async()=>{try{const d=await z();r.value=d.data,i.captcha_id=d.data.captcha_id}catch{A.error("获取验证码失败")}},l=()=>{g.value?(localStorage.setItem(R,i.userName),localStorage.setItem(S,window.btoa(i.password))):(localStorage.removeItem(R),localStorage.removeItem(S))},m=U(),n=N(),{loading:F,setLoading:w}=Q(),C=async({errors:d,values:p})=>{if(!d){w(!0);try{await n.login(p),l();const{redirect:f,...T}=m.currentRoute.value.query;await m.push({name:f||"workplace",query:{...T}}),A.success("欢迎使用")}catch(f){console.error("登录失败:",f)}finally{w(!1)}}},b=()=>{o.emit("callRegister")},_=()=>{o.emit("callForgotPassword")};return k(()=>{t();const d=localStorage.getItem(R),p=localStorage.getItem(S);d&&p&&(i.userName=d,i.password=window.atob(p),g.value=!0)}),{logoIcon:q,loading:F,userInfo:i,captcha:r,rememberPassword:g,fetchCaptcha:t,callRegister:b,callForgotPassword:_,handleSubmit:C}}}),te={class:"login-form-wrapper"},ne={class:"login-form-title"},re=["src"],le=["src"],ie={class:"login-form-password-actions"};function de(e,o,g,i,r,t){const l=u("icon-user"),m=u("a-input"),n=u("a-form-item"),F=u("icon-lock"),w=u("a-input-password"),C=u("icon-safe"),b=u("a-checkbox"),_=u("a-button"),d=u("a-space"),p=u("a-form");return h(),v("div",te,[c("div",ne,[c("img",{src:e.logoIcon,alt:"logo"},null,8,re),o[5]||(o[5]=c("span",null,"QLToolsV2",-1))]),a(p,{model:e.userInfo,size:"large",layout:"vertical",onSubmit:e.handleSubmit},{default:s(()=>[a(n,{field:"userName",rules:[{required:!0,message:"用户名不能为空"}],"validate-trigger":["change","blur"],"hide-label":""},{default:s(()=>[a(m,{modelValue:e.userInfo.userName,"onUpdate:modelValue":o[0]||(o[0]=f=>e.userInfo.userName=f),placeholder:"用户名：admin",onKeyup:y(e.handleSubmit,["enter"])},{prefix:s(()=>[a(l)]),_:1},8,["modelValue","onKeyup"])]),_:1}),a(n,{field:"password",rules:[{required:!0,message:"密码不能为空"}],"validate-trigger":["change","blur"],"hide-label":""},{default:s(()=>[a(w,{modelValue:e.userInfo.password,"onUpdate:modelValue":o[1]||(o[1]=f=>e.userInfo.password=f),autocomplete:"new-password",placeholder:"密码：admin","allow-clear":"",onKeyup:y(e.handleSubmit,["enter"])},{prefix:s(()=>[a(F)]),_:1},8,["modelValue","onKeyup"])]),_:1}),a(n,{field:"captcha_code",rules:[{required:!0,message:"验证码不能为空"}],"validate-trigger":["change","blur"],"hide-label":""},{default:s(()=>[a(m,{modelValue:e.userInfo.captcha_code,"onUpdate:modelValue":o[3]||(o[3]=f=>e.userInfo.captcha_code=f),placeholder:"请输入验证码",onKeyup:y(e.handleSubmit,["enter"])},{prefix:s(()=>[a(C)]),append:s(()=>[e.captcha.captcha_base64?(h(),v("img",{key:0,src:e.captcha.captcha_base64,alt:"Captcha",onClick:o[2]||(o[2]=(...f)=>e.fetchCaptcha&&e.fetchCaptcha(...f))},null,8,le)):L("",!0)]),_:1},8,["modelValue","onKeyup"])]),_:1}),a(d,{size:16,direction:"vertical"},{default:s(()=>[c("div",ie,[a(b,{modelValue:e.rememberPassword,"onUpdate:modelValue":o[4]||(o[4]=f=>e.rememberPassword=f)},{default:s(()=>[...o[6]||(o[6]=[B(" 自动登录 ",-1)])]),_:1},8,["modelValue"])]),a(_,{type:"primary","html-type":"submit",long:"",loading:e.loading},{default:s(()=>[...o[7]||(o[7]=[B(" 登录 ",-1)])]),_:1},8,["loading"]),a(_,{type:"outline",long:"",onClick:e.callRegister},{default:s(()=>[...o[8]||(o[8]=[B(" 注册账号 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","onSubmit"])])}const ce=I(ue,[["render",de],["__scopeId","data-v-52691ae4"]]);function pe(){return{emailRules:[{required:!0,message:"请输入邮箱地址"},{validator:(r,t)=>{if(!/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(r)){t("请填写正确的邮箱地址");return}t()}}],phoneRules:[{required:!0,message:"请输入手机号码"},{validator:(r,t)=>{if(!/^(13[0-9]|14[5|7]|15[0|1|2|3|4|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$/.test(r)){t("请填写正确的手机号码");return}t()}}],passwordRules:[{required:!0,message:"请输入密码"},{validator:(r,t)=>{if(!/^[a-zA-Z]\w{5,17}$/.test(r)){t("以字母开头，长度在6~18之间，只能包含字母、数字和下划线");return}t()}}],identityCardRules:[{required:!0,message:"请输入身份证号码"},{validator:(r,t)=>{if(!/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(r)){t("请填写正确的身份证号码");return}t()}}]}}const me=D({emits:["callLogin"],setup(e,o){const g=$(null),i=P({username:"",password:"",re_password:"",captcha_code:"",captcha_id:""}),{passwordRules:r}=pe(),t=[{required:!0,message:"请再次输入密码"},{validator:(_,d)=>{_!==i.password?d("两次输入的密码不一致"):d()}}],l=$({captcha_id:"",captcha_base64:""}),m=async()=>{try{const _=await z();l.value=_.data,i.captcha_id=_.data.captcha_id}catch{A.error("获取验证码失败")}},n=()=>{o.emit("callLogin")},F=N(),{loading:w,setLoading:C}=Q(),b=async({errors:_,values:d})=>{if(!_){C(!0);try{await F.register(d),n(),A.success("注册成功")}finally{C(!1)}}};return k(()=>{m()}),{logoIcon:q,loading:w,userInfo:i,captcha:l,rePasswordRules:t,passwordRules:r,registerFormRef:g,fetchCaptcha:m,callLogin:n,handleSubmit:b}}}),ge={class:"register-form-wrapper"},_e={class:"register-form-title"},fe=["src"],he=["src"];function Fe(e,o,g,i,r,t){const l=u("icon-user"),m=u("a-input"),n=u("a-form-item"),F=u("icon-lock"),w=u("a-input-password"),C=u("icon-safe"),b=u("a-button"),_=u("a-space"),d=u("a-form");return h(),v("div",ge,[c("div",_e,[c("img",{src:e.logoIcon,alt:"logo"},null,8,fe),o[5]||(o[5]=c("span",null,"QLToolsV2",-1))]),a(d,{ref:"registerFormRef",model:e.userInfo,size:"large",layout:"vertical",onSubmit:e.handleSubmit},{default:s(()=>[a(n,{field:"username",rules:[{required:!0,message:"请输入用户名"}],"validate-trigger":["change","blur"],"hide-label":""},{default:s(()=>[a(m,{modelValue:e.userInfo.username,"onUpdate:modelValue":o[0]||(o[0]=p=>e.userInfo.username=p),placeholder:"请输入用户名",onKeyup:y(e.handleSubmit,["enter"])},{prefix:s(()=>[a(l)]),_:1},8,["modelValue","onKeyup"])]),_:1}),a(n,{field:"password",rules:e.passwordRules,"validate-trigger":["change","blur"],"hide-label":""},{default:s(()=>[a(w,{modelValue:e.userInfo.password,"onUpdate:modelValue":o[1]||(o[1]=p=>e.userInfo.password=p),autocomplete:"new-password",placeholder:"请输入密码","allow-clear":"",onKeyup:y(e.handleSubmit,["enter"])},{prefix:s(()=>[a(F)]),_:1},8,["modelValue","onKeyup"])]),_:1},8,["rules"]),a(n,{field:"re_password",rules:e.rePasswordRules,"validate-trigger":["change","blur"],"hide-label":""},{default:s(()=>[a(w,{modelValue:e.userInfo.re_password,"onUpdate:modelValue":o[2]||(o[2]=p=>e.userInfo.re_password=p),autocomplete:"new-password",placeholder:"请再次输入密码","allow-clear":"",onKeyup:y(e.handleSubmit,["enter"])},{prefix:s(()=>[a(F)]),_:1},8,["modelValue","onKeyup"])]),_:1},8,["rules"]),a(n,{field:"captcha_code",rules:[{required:!0,message:"验证码不能为空"}],"validate-trigger":["change","blur"],"hide-label":""},{default:s(()=>[a(m,{modelValue:e.userInfo.captcha_code,"onUpdate:modelValue":o[4]||(o[4]=p=>e.userInfo.captcha_code=p),placeholder:"请输入验证码",onKeyup:y(e.handleSubmit,["enter"])},{prefix:s(()=>[a(C)]),append:s(()=>[e.captcha.captcha_base64?(h(),v("img",{key:0,src:e.captcha.captcha_base64,alt:"Captcha",onClick:o[3]||(o[3]=(...p)=>e.fetchCaptcha&&e.fetchCaptcha(...p))},null,8,he)):L("",!0)]),_:1},8,["modelValue","onKeyup"])]),_:1}),a(_,{size:16,direction:"vertical"},{default:s(()=>[a(b,{type:"primary","html-type":"submit",long:"",loading:e.loading},{default:s(()=>[...o[6]||(o[6]=[B(" 注册 ",-1)])]),_:1},8,["loading"]),a(b,{type:"outline",long:"",onClick:e.callLogin},{default:s(()=>[...o[7]||(o[7]=[B(" 返回",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","onSubmit"])])}const we=I(me,[["render",Fe],["__scopeId","data-v-c06dbd84"]]);var M=(e=>(e[e.Login=0]="Login",e[e.Register=1]="Register",e))(M||{});const Ce=D({components:{LoginBanner:se,LoginForm:ce,RegisterForm:we,Footer:W},setup(){const e=U(),o=Z(),g=$(0),i=()=>{g.value=0},r=()=>{g.value=1};return k(()=>{if(G()){const{redirect:t,...l}=o.query;e.push({name:t||"workplace",query:{...l}})}}),{showPage:g,logoIcon:q,PageEnum:M,callLogin:i,callRegister:r}}}),be={class:"container"},ve={class:"logo"},ye=["src"],Be={class:"content"},$e={class:"content-inner"},Ae={class:"footer"};function Ie(e,o,g,i,r,t){const l=u("LoginBanner"),m=u("LoginForm"),n=u("RegisterForm"),F=u("Footer");return h(),v("div",be,[c("div",ve,[c("img",{src:e.logoIcon,alt:"logo"},null,8,ye),o[0]||(o[0]=c("div",{class:"logo-text"},"QLToolsV2",-1))]),a(l),c("div",Be,[c("div",$e,[e.showPage===e.PageEnum.Login?(h(),V(m,{key:0,onCallRegister:e.callRegister},null,8,["onCallRegister"])):e.showPage===e.PageEnum.Register?(h(),V(n,{key:1,onCallLogin:e.callLogin},null,8,["onCallLogin"])):L("",!0)]),c("div",Ae,[a(F)])])])}const Re=I(Ce,[["render",Ie],["__scopeId","data-v-179ee953"]]);export{Re as default};
